# 사용자 플로우 문서

## 📋 목차
1. [회원가입 플로우](#1-회원가입-플로우)
2. [로그인 플로우](#2-로그인-플로우)
3. [프로필 완성 플로우](#3-프로필-완성-플로우)
4. [어드민 초대 플로우](#4-어드민-초대-플로우)
5. [전문가 플로우](#5-전문가-플로우)
6. [조직 플로우](#6-조직-플로우)
7. [캠페인 매칭 플로우](#7-캠페인-매칭-플로우)

---

## 1. 회원가입 플로우

### 1.1 일반 회원가입

```
시작
  ↓
[메인 페이지] → "회원가입" 클릭
  ↓
[회원가입 타입 선택 페이지] (/auth/register)
  ├─ 전문가 회원가입
  └─ 조직 회원가입
  ↓
[회원가입 폼] (/auth/register/expert 또는 /auth/register/organization)
  ├─ 이메일 입력
  ├─ 비밀번호 입력 (비밀번호 표시/숨김 토글)
  ├─ 비밀번호 확인
  ├─ 약관 동의 체크박스
  └─ "회원가입" 버튼 클릭
  ↓
[회원가입 처리]
  ├─ 성공 → 이메일 인증 안내
  └─ 실패 → 에러 메시지 표시
  ↓
[이메일 인증 대기]
  ↓
[이메일 확인 완료] → 자동 로그인
  ↓
[프로필 완성 페이지로 리다이렉트]
```

### 1.2 어드민 초대 회원가입 (신규)

```
[어드민 페이지] (/admin/users)
  ↓
"사용자 초대" 버튼 클릭
  ↓
[초대 폼 다이얼로그]
  ├─ 이메일 입력 (ID로 사용)
  ├─ 이름 입력
  ├─ 전화번호 입력 (초기 비밀번호)
  ├─ 역할 선택 (전문가/조직)
  ├─ 조직명 입력 (조직인 경우)
  └─ 직책 입력 (조직인 경우)
  ↓
[초대 생성]
  ├─ 계정 자동 생성 (이메일=ID, 전화번호=비밀번호)
  ├─ 초대 토큰 생성
  └─ 초대 이메일 발송
  ↓
[사용자 이메일 수신]
  ↓
[초대 링크 클릭] (/auth/invite/accept/[token])
  ├─ 초대 정보 로드
  ├─ 자동 로그인 시도
  └─ 프로필 정보 입력 폼 표시
  ↓
[프로필 정보 입력]
  ├─ 이름 확인/수정
  ├─ 전화번호 확인/수정
  ├─ 조직명 입력 (조직인 경우)
  ├─ 직책 입력 (조직인 경우)
  └─ 비밀번호 변경 (선택)
  ↓
[프로필 완성] → 대시보드로 이동
```

---

## 2. 로그인 플로우

```
시작
  ↓
[메인 페이지] → "로그인" 클릭
  ↓
[로그인 페이지] (/auth/login)
  ├─ 이메일 입력
  ├─ 비밀번호 입력
  └─ "로그인" 버튼 클릭
  ↓
[로그인 처리]
  ├─ 성공
  │   ├─ 사용자 역할 확인
  │   ├─ 프로필 완성 여부 확인
  │   └─ 리다이렉트
  │       ├─ 프로필 미완성 → 프로필 완성 페이지
  │       └─ 프로필 완성 → 대시보드
  └─ 실패 → 에러 메시지 표시
```

### 리다이렉트 로직
- **전문가 + 프로필 미완성**: `/profile/expert/complete`
- **조직 + 프로필 미완성**: `/profile/organization/complete`
- **프로필 완성**: `/dashboard`

---

## 3. 프로필 완성 플로우

### 3.1 전문가 프로필 완성

```
[전문가 프로필 완성 페이지] (/profile/expert/complete)
  ↓
[Multi-Step Wizard]
  ├─ Step 1: 기본 정보
  │   ├─ 이름
  │   ├─ 이메일
  │   ├─ 전화번호
  │   └─ 프로필 사진
  ├─ Step 2: 경력 정보
  │   ├─ 경력 추가
  │   └─ 경력 목록
  ├─ Step 3: 학력 정보 (선택)
  │   ├─ 학력 추가
  │   └─ 학력 목록
  ├─ Step 4: 스킬 및 전문성
  │   ├─ 스킬 태그
  │   └─ 전문 분야
  ├─ Step 5: 포트폴리오 (선택)
  │   └─ 포트폴리오 URL
  └─ "건너뛰기" 버튼 (선택 항목)
  ↓
[진행상황 저장] (자동 저장)
  ↓
[완료] → 대시보드로 이동
```

### 3.2 조직 프로필 완성

```
[조직 프로필 완성 페이지] (/profile/organization/complete)
  ↓
[프로필 폼]
  ├─ 조직명
  ├─ 사업자등록번호
  ├─ 대표자명
  ├─ 담당자 직책
  ├─ 산업 분야
  ├─ 직원 수
  ├─ 웹사이트
  └─ 조직 소개
  ↓
[완료] → 대시보드로 이동
```

---

## 4. 어드민 초대 플로우

### 4.1 어드민이 사용자 초대

```
[어드민 대시보드] (/admin)
  ↓
"사용자 관리" 메뉴 클릭
  ↓
[사용자 관리 페이지] (/admin/users)
  ↓
"사용자 초대" 버튼 클릭
  ↓
[초대 다이얼로그]
  ├─ 필수 정보 입력
  │   ├─ 이메일 (ID)
  │   ├─ 이름
  │   ├─ 전화번호 (초기 비밀번호)
  │   └─ 역할
  └─ 선택 정보 입력 (조직인 경우)
      ├─ 조직명
      └─ 직책
  ↓
[초대 생성]
  ├─ API 호출 (/api/admin/invite-user)
  ├─ 계정 생성
  ├─ 초대 토큰 생성
  └─ 이메일 발송
  ↓
[성공 메시지 표시]
  ├─ 사용자 목록 새로고침
  └─ 다이얼로그 닫기
```

### 4.2 초대된 사용자 플로우

```
[이메일 수신]
  ├─ 초대 링크
  ├─ 로그인 정보 안내
  └─ 링크 클릭
  ↓
[초대 수락 페이지] (/auth/invite/accept/[token])
  ├─ 초대 정보 로드
  ├─ 토큰 검증
  └─ 만료 확인
  ↓
[자동 로그인 시도]
  ├─ 성공
  │   ├─ 프로필 완성도 확인
  │   ├─ 완성됨 → 대시보드
  │   └─ 미완성 → 프로필 입력 폼
  └─ 실패 → 수동 로그인 안내
  ↓
[프로필 정보 입력]
  ├─ 이름 확인/수정
  ├─ 전화번호 확인/수정
  ├─ 조직명 입력 (조직인 경우)
  ├─ 직책 입력 (조직인 경우)
  └─ 비밀번호 변경 (선택)
  ↓
[프로필 완성] → 대시보드로 이동
```

---

## 5. 전문가 플로우

### 5.1 대시보드

```
[전문가 대시보드] (/dashboard)
  ├─ 통계 카드
  │   ├─ 활성 캠페인 수
  │   ├─ 제안서 수
  │   ├─ 메시지 수
  │   └─ 연결 수
  ├─ 최근 캠페인 목록
  ├─ 추천 캠페인
  └─ 빠른 액션
      ├─ 캠페인 찾기
      └─ 프로필 편집
```

### 5.2 캠페인 탐색 및 제안

```
[캠페인 목록] (/dashboard/campaigns)
  ├─ 검색 필터
  │   ├─ 키워드 검색
  │   ├─ 카테고리 필터
  │   └─ 예산 범위
  └─ 캠페인 카드 목록
      ├─ 캠페인 제목
      ├─ 조직명
      ├─ 예산 범위
      └─ "상세보기" 버튼
  ↓
[캠페인 상세 페이지] (/dashboard/campaigns/[id])
  ├─ 캠페인 정보
  │   ├─ 제목
  │   ├─ 설명
  │   ├─ 요구사항
  │   └─ 예산
  └─ "제안하기" 버튼
  ↓
[제안서 작성 페이지] (/dashboard/campaigns/[id]/propose)
  ├─ 제안서 내용
  │   ├─ 자기소개서
  │   ├─ 제안 예산
  │   ├─ 제안 일정
  │   └─ 첨부파일
  ├─ 자동 저장 (3초마다)
  └─ "제안서 제출" 버튼
  ↓
[제안서 제출]
  ├─ 성공 → 제안서 목록으로 이동
  └─ 실패 → 에러 메시지 표시
```

### 5.3 제안서 관리

```
[제안서 목록] (/dashboard/proposals)
  ├─ 상태별 필터
  │   ├─ 대기중
  │   ├─ 수락됨
  │   ├─ 거절됨
  │   └─ 철회됨
  └─ 제안서 카드
      ├─ 캠페인 정보
      ├─ 제출 일시
      ├─ 상태
      └─ 액션 버튼
          ├─ 상세보기
          └─ 철회 (대기중인 경우)
```

---

## 6. 조직 플로우

### 6.1 대시보드

```
[조직 대시보드] (/dashboard)
  ├─ 통계 카드
  │   ├─ 활성 캠페인 수
  │   ├─ 제안서 수
  │   ├─ 진행중 프로젝트
  │   └─ 완료된 프로젝트
  ├─ 최근 캠페인 목록
  └─ 빠른 액션
      ├─ 새 캠페인 만들기
      └─ 전문가 찾기
```

### 6.2 캠페인 생성 및 관리

```
[캠페인 목록] (/dashboard/campaigns)
  ├─ "새 캠페인 만들기" 버튼
  └─ 캠페인 목록
      ├─ 상태별 필터
      └─ 캠페인 카드
  ↓
[캠페인 생성 페이지] (/dashboard/campaigns/create)
  ├─ 캠페인 폼
  │   ├─ 제목 * (도움말 포함)
  │   ├─ 설명 * (예시 템플릿 포함)
  │   ├─ 타입 선택
  │   ├─ 카테고리
  │   ├─ 키워드 태그
  │   ├─ 예산 범위
  │   ├─ 기간
  │   ├─ 위치
  │   └─ 필요 전문가 수
  ├─ 자동 저장 (3초마다)
  └─ "캠페인 생성" 버튼
  ↓
[캠페인 생성]
  ├─ 성공 → 캠페인 목록으로 이동
  └─ 실패 → 에러 메시지 표시
  ↓
[캠페인 상세 페이지] (/dashboard/campaigns/[id])
  ├─ 캠페인 정보
  ├─ 제안서 목록
  │   ├─ 제안서 카드
  │   │   ├─ 전문가 정보
  │   │   ├─ 제안 예산
  │   │   ├─ 제안 일정
  │   │   └─ 액션 버튼
  │   │       ├─ 수락
  │   │       └─ 거절
  │   └─ 필터
  └─ 캠페인 관리
      ├─ 편집
      └─ 삭제 (제안서 없을 경우)
```

---

## 7. 캠페인 매칭 플로우

### 7.1 자동 매칭 시스템

```
[새 캠페인 생성]
  ↓
[캠페인 저장 완료]
  ↓
[매칭 알고리즘 실행]
  ├─ 전문가 스킬과 캠페인 요구사항 매칭
  ├─ 전문가 경력과 캠페인 타입 매칭
  └─ 전문가 위치와 캠페인 위치 매칭
  ↓
[매칭된 전문가에게 알림 발송]
  ├─ 이메일 알림
  └─ 앱 내 알림
  ↓
[전문가 대시보드에 추천 캠페인 표시]
```

### 7.2 제안서 수락/거절 플로우

```
[조직이 제안서 확인]
  ↓
[제안서 상세 보기]
  ├─ 전문가 프로필
  ├─ 제안 내용
  ├─ 제안 예산
  └─ 제안 일정
  ↓
[의사 결정]
  ├─ 수락
  │   ├─ 제안서 상태 변경 (수락됨)
  │   ├─ 전문가에게 알림 발송
  │   ├─ 프로젝트 생성 (선택)
  │   └─ 메시지 시작 (선택)
  └─ 거절
      ├─ 제안서 상태 변경 (거절됨)
      ├─ 전문가에게 알림 발송
      └─ 거절 사유 입력 (선택)
  ↓
[알림 발송]
  ├─ 이메일 알림
  └─ 앱 내 알림
```

---

## 8. 공통 플로우

### 8.1 메시징

```
[대시보드] → "메시지" 메뉴 클릭
  ↓
[메시지 목록] (/dashboard/messages)
  ├─ 대화 목록
  └─ "새 메시지" 버튼
  ↓
[대화 상세] (/dashboard/messages/[id])
  ├─ 메시지 히스토리
  ├─ 메시지 입력
  └─ "전송" 버튼
```

### 8.2 알림

```
[알림 아이콘 클릭]
  ↓
[알림 목록]
  ├─ 읽지 않은 알림
  ├─ 읽은 알림
  └─ 알림 타입
      ├─ 캠페인 매칭
      ├─ 제안서 수신
      ├─ 메시지
      └─ 시스템
  ↓
[알림 클릭]
  └─ 관련 페이지로 이동
```

### 8.3 프로필 편집

```
[대시보드] → "프로필" 메뉴 클릭
  ↓
[프로필 페이지]
  ├─ 프로필 정보
  ├─ "편집" 버튼
  └─ 편집 폼
      ├─ 정보 수정
      └─ "저장" 버튼
```

---

## 9. 플로우 다이어그램

### 9.1 전체 사용자 여정

```
[방문자]
  ├─ 회원가입 → [전문가/조직] → 프로필 완성 → 대시보드
  ├─ 로그인 → [인증] → 프로필 확인 → 대시보드/프로필 완성
  └─ 어드민 초대 → [이메일] → 초대 수락 → 프로필 완성 → 대시보드
```

### 9.2 전문가 활동 플로우

```
[전문가 대시보드]
  ├─ 캠페인 탐색 → 캠페인 상세 → 제안서 작성 → 제안서 제출
  ├─ 제안서 관리 → 제안서 상세 → 상태 확인
  ├─ 매칭 알림 수신 → 캠페인 확인 → 제안서 작성
  └─ 메시지 확인 → 대화 참여
```

### 9.3 조직 활동 플로우

```
[조직 대시보드]
  ├─ 캠페인 생성 → 캠페인 상세 → 제안서 확인 → 수락/거절
  ├─ 캠페인 관리 → 캠페인 편집/삭제
  ├─ 전문가 찾기 → 전문가 프로필 확인 → 연결 요청
  └─ 메시지 확인 → 대화 참여
```

---

## 10. 개선 제안

### 10.1 현재 플로우의 문제점

1. **프로필 완성 단계가 복잡함**
   - Multi-step wizard가 너무 많은 단계
   - 필수/선택 항목 구분이 불명확

2. **캠페인 생성이 복잡함**
   - 많은 입력 필드
   - 필수/선택 항목 구분 불명확

3. **초대 플로우가 복잡함**
   - 초대 수락 페이지에서 정보 입력이 많음

### 10.2 개선 제안

#### 10.2.1 프로필 완성 단순화
- **현재**: 5단계 Multi-step wizard
- **개선안**: 
  - 필수 정보만 먼저 수집 (1단계)
  - 선택 정보는 "나중에 완성하기" 옵션 제공
  - 대시보드에서 점진적 프로필 완성 유도

#### 10.2.2 캠페인 생성 단순화
- **현재**: 모든 필드가 한 페이지에
- **개선안**:
  - 단계별 폼 (기본 정보 → 상세 정보)
  - 필수 필드만 먼저 수집
  - 템플릿 제공 (예시 캠페인)

#### 10.2.3 초대 수락 단순화
- **현재**: 모든 정보를 다시 입력
- **개선안**:
  - 어드민이 입력한 정보는 자동 채움
  - 사용자는 확인만 하면 됨
  - 비밀번호 변경만 선택적으로

#### 10.2.4 온보딩 개선
- 첫 방문 사용자를 위한 가이드
- 단계별 튜토리얼
- 빠른 시작 가이드

---

## 11. 기술적 구현 상세

### 11.1 라우팅 구조

```
/auth
  /login
  /register
    /expert
    /organization
  /invite
    /accept/[token]

/profile
  /expert
    /complete
    /edit
  /organization
    /complete
    /edit

/dashboard
  /campaigns
    /create
    /[id]
      /propose
      /edit
  /proposals
  /messages
  /experts
  /notifications

/admin
  /users
  /campaigns
  /proposals
```

### 11.2 상태 관리

- **인증 상태**: `AuthContext` (전역)
- **사용자 역할**: `user_metadata.role`
- **프로필 완성도**: `is_profile_complete` 플래그
- **폼 데이터**: React Hook Form + 자동 저장

### 11.3 자동 저장 로직

- **캠페인 생성**: 3초 지연 후 자동 저장
- **제안서 작성**: 3초 지연 후 자동 저장
- **프로필 완성**: 단계별 저장

---

## 📝 참고

이 문서는 현재 구현된 플로우를 기반으로 작성되었습니다.
실제 사용자 테스트를 통해 플로우를 지속적으로 개선해야 합니다.

